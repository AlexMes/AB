<?php

namespace App\Console\Commands;

use App\Lead;
use App\SmsCampaign;
use Illuminate\Console\Command;

class SenSmsToLeadOnetime extends Command
{
    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $signature = 'sms:onetime';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Command sen sms to leads onetime';

    protected $phones = [
        '79851573212',
        '79298056000',
        '79854100518',
        '79288783641',
        '79999190512',
        '79853027383',
        '79897410690',
        '79951108005',
        '79621064688',
        '79778970703',
        '79145645322',
        '79003522654',
        '79145577775',
        '79149863197',
        '79167269343',
        '79263726708',
        '79294946680',
        '79130201042',
        '79961838378',
        '79137573224',
        '79885616879',
        '79025641763',
        '79831318089',
        '79504222989',
        '79800605946',
        '79265468867',
        '79021738050',
        '79514247714',
        '79232804124',
        '79142667901',
        '79620653772',
        '79373727627',
        '79521569777',
        '79282294807',
        '79098306872',
        '79069106331',
        '79275391020',
        '79054700778',
        '79526753196',
        '79996258869',
        '79829892999',
        '79635367901',
        '79510317427',
        '79831111544',
        '79635313838',
        '79686887756',
        '79224350792',
        '79632890057',
        '79817037777',
        '79213297453',
        '79178162981',
        '79034343170',
        '79141247887',
        '79280940096',
        '79205352334',
        '79140923340',
        '79184629152',
        '79614447722',
        '79180459145',
        '79285435075',
        '79124615414',
        '79098797992',
        '79869834465',
        '79098664452',
        '79828870410',
        '79220049000',
        '79082244560',
        '79510311711',
        '79269032927',
        '79289091899',
        '79133013050',
        '79663304535',
        '79640025776',
        '79113695393',
        '79031160623',
        '79508124948',
        '79276857564',
        '79177559260',
        '79081257926',
        '79160690371',
        '79613587775',
        '79520005511',
        '79058793133',
        '79298821000',
        '79207448199',
        '79028088609',
        '79650010544',
        '79526246858',
        '79202769950',
        '79626610681',
        '79197246444',
        '79889257822',
        '79224166511',
        '79687773336',
        '79800603401',
        '79999100443',
        '79241176299',
        '79036668542',
        '79236255626',
        '79044599775',
        '79500134110',
        '79099004453',
        '79212508183',
        '79370296653',
        '79882919699',
        '79053012277',
        '79516272200',
        '79136949313',
        '79652650050',
        '79137009988',
        '79875080248',
        '79604082987',
        '79146158058',
        '79283755840',
        '79284793437',
        '79049995474',
        '79272826120',
        '79285607236',
        '79108089313',
        '79233836006',
        '79014046526',
        '79620800423',
        '79997105460',
        '79109507277',
        '79524413877',
        '79184219888',
        '79277324608',
        '79036604466',
        '79135325755',
        '79222887177',
        '79039695095',
        '79388987234',
        '79151850075',
        '79261460099',
        '79189108989',
        '79898381488',
        '79505615855',
        '79998589619',
        '79029134126',
        '79853595740',
        '79281525050',
        '79033767288',
        '79502673393',
        '79103601371',
        '79774106299',
        '79299611190',
        '79026073340',
        '79601902229',
        '79245866038',
        '79182772829',
        '79996758835',
        '79217017808',
        '79275799468',
    ];

    /**
     * Create a new command instance.
     *
     * @return void
     */
    public function __construct()
    {
        parent::__construct();
    }

    /**
     * Execute the console command.
     *
     * @return mixed
     */
    public function handle()
    {
        $progress = 0;

        foreach ($this->phones as $phone) {
            $lead = Lead::where('phone', 'like', '%' . substr($phone, 1))->valid()->first();
            if ($progress <= 100 && $lead) {
                $progress++;
                SmsCampaign::find(31)->sendSMS($lead);
                $this->info('progress ' . $progress);
                $this->info('Sms sented ' . $phone);
                sleep(rand(1, 4));
            }
        }

        $this->info('Sms sented');
    }

    protected function send($date)
    {
    }
}
